---
title: 'Exercise #3'
subtitle: "Fortgeschrittene Statistische Software für NF"
author: "Frederik Borutta (10345490) / Felix Borutta (10049639)"
date: "`r Sys.Date()`"
output: distill::distill_article
bibliography: packages.bib
nocite: '@*'
---

```{r setup, include=FALSE}
options(repos = c(CRAN = "https://cran.rstudio.com/"))
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE)
install.packages("distill")
install.packages("ggplot2")
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)

knitr::write_bib(c(.packages()), "packages.bib")
setwd("C:/Studium/Fortgeschrittene_Statistische_Software/Exercise_03")
```

## Exercise 1: Initializing git (4 Points)

a) Start by initializing a new R project with git support, called 2025-exeRcise-sheet-3. If you forgot
how to do this, you can follow this guide.


b) Commit the files generated by Rstudio.


c) For all of the following tasks in this exercise sheet we ask you to always commit your changes after
finishing each subtask e.g. create a commit after task 1d, 1e etc.
Note: This applies only to answers that have text or code as their answer. If you complete tasks
in a different order or forget to commit one, this is no problem. If you change your answers you
can just create multiple commits to track the changes.


d) Name 2 strengths and 2 weaknesses of git. (Don’t forget to create a commit after this answer, see 1c)

Strenghts:
  * Good for collaboration in teams, with multiple developers/contributers.
  * Branching and multiple merging strategies are possible.

Weaknesses:
  * Could be complex in the beginning, for example solving merge conflicts or to get a linear log graph with rebase strategy.
  * Git is mainly used for source code version control. Large files, containing multimedia content or similiar big data structures, are not supported well by git.

e) Knit this exercise sheet. Some new files will automatically be generated when knitting the sheet e.g. the
HTML page. Ignore these files, as we only want to track the source files themselves. You can, but
don’t need to create a .gitignore file. Just do not commit these files manually.


## Exercise 2: Putting your Repository on GitHub (3 Points)

a) Create a new repository on GitHub in your account named exeRcise-sheet-3. Make sure you create
a public repository so we are able to see it for grading. Add the link to the repository below:

https://github.com/Fred1589/exeRcise-sheet-3#


b) Push your code to this new repository by copying and executing the snippet on github listed under
...or push an existing repository from the command line.


c) Regularly push your latest changes to GitHub again and especially do so when you are finished with
this sheet.

## Exercise 3: Pixar Films (4 Points)

a) Load the pixar_films dataset into R. Clean the dataset by removing films without a title. Inspect the
variable film_rating. What are the possible values and what do they mean? Create a factor variable
for the film rating. Why is this appropriate?

```{r pixar-films-load-and-view-data}
pixar_films = read_csv("pixar_films.csv")
head(pixar_films, n = 5)

pixar_films_cleaned <- pixar_films %>% 
  filter(!is.na(film))

print(unique(pixar_films_cleaned$film_rating))

pixar_films_cleaned$film_rating <- as.factor(pixar_films_cleaned$film_rating)
```

Rating based on Motion Picture Association (MPA) film rating system.
G - General Audience
PG - Parental Guidance Suggested
PG-13 - Parents Strongly Cautioned
R - Restricted
NC-17 - No One 17 And Under Admitted
N/A - Not Available

The column film_rating is appropriated for factor, because it will categorize the films. With a factorization, an efficient storage, with view on the rating, is possible.


b) Inspect the film titles manually. Which films form a film series? A film series can be identified by a
common word in the titles of the films, often in conjunction with a number in the title, e.g. “Despicable
Me” and “Despicable Me 2”. Create a dataframe which displays a list of the different series with the
titles of the films and how many films belong to the series. Output the dataframe.

```{r pixar-film-series}
pixar_film_series <- data.frame(
  series = c("Cars", "Finding Nemo", "Incredibles", "Monsters, Inc", "Toy Story"),
  films = I(list(
    c("Cars", "Cars 2", "Cars 3"),
    c("Finding Nemo", "Finding Dory"),
    c("The Incredibles", "Incredibles 2"),
    c("Monsters, Inc.", "Monsters University"),
    c("Toy Story", "Toy Story 2", "Toy Story 3", "Toy Story 4")
  )),
  amount = c(3, 2, 2, 2, 4)
)

head(pixar_film_series, n = 5)
```

c) Load the public_response dataframe into R. Convert the cinema_score variable into a factor while
ensuring the factor levels are defined in ascending order, from the lowest to the highest score. Combine
public_response with the pixar_films dataset using an appropriate merge variable.

```{r public-response-load-and-view-data}
public_response = read_csv("public_response.csv")
head(public_response, n = 5)

public_response$cinema_score <- factor(public_response$cinema_score, levels = sort(unique(public_response$cinema_score)), ordered = TRUE)

film_df_joined <- left_join(pixar_films_cleaned, 
                            public_response, 
                            by = c("film" = "film"))
                            
print(film_df_joined)
```

d) Choose one of the variables representing the public response and create a bar plot for the films belonging
to a series. Here are the details of the plot:  
• The film series are represented on the x-axis.  
• Your chosen public response variable is displayed on the y-axis.  
• Each film in the series is represented as a separate bar. Bars are grouped by film under their
respective series on the x-axis. Order the bars within a series according to the release date of the
films.  
• A title and axis labels for context.  
What do you notice when comparing the scores of the films in a series? Do you see any patterns?


```{r plot-rotten-tomatoes}
series_lookup <- pixar_film_series %>%
  unnest(films) %>%
  rename(film = films) %>% 
  arrange(film)

joined_df <- pixar_films %>%
  inner_join(public_response, by = "film") %>%
  inner_join(series_lookup, by = "film") %>%
  arrange(series, release_date)

joined_df$film <- factor(joined_df$film, levels = joined_df$film[order(joined_df$series, joined_df$release_date)])

ggplot(joined_df, aes(x = series, y = rotten_tomatoes, fill = film)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
  labs(
    title = "Rotten Tomatoes Scores of Pixar Film Series",
    x = "Film Series",
    y = "Rotten Tomatoes Score"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))
```

## Exercise 4: Open Analysis (4 points)

c) 
* Dataset Name: Meat consumption in the USA (USDA, 2018)
* Link: https://github.com/owid/owid-datasets/tree/master/datasets/Meat%20consumption%20in%20the%20USA%20(USDA%2C%202018)

d) Is the red meat consumption decreasing rate faster than the one of total meat consumption? We believe it is interesting to see if the awareness of the relationship between climate change and red meat production is visible in the consumption pattern of US citizens.


